{% extends "base.html" %}

{% block title %}View Data - {{ job.name }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
    <h1 class="h2"><i class="bi bi-table"></i> Transformed Data: {{ job.name }}</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <a href="{{ url_for('jobs.view_job', job_id=job.id) }}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Back to Job
        </a>
    </div>
</div>

{% if table_html %}
<div class="card mb-3">
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <p class="mb-0"><strong>Total Rows:</strong> {{ total_rows }}</p>
            </div>
            <div class="col-md-6">
                <p class="mb-0"><strong>Columns:</strong> {{ columns|length }}</p>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="mb-0">Data Preview (First 100 rows)</h5>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive" style="max-height: 600px; overflow-y: auto;">
            {{ table_html|safe }}
        </div>
    </div>
</div>

<div class="mt-3">
    <div class="card">
        <div class="card-header">
            <h6 class="mb-0">Column Names</h6>
        </div>
        <div class="card-body">
            <div class="row">
                {% for col in columns %}
                <div class="col-md-3 mb-2">
                    <span class="badge bg-secondary">{{ col }}</span>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="alert alert-warning">
    <i class="bi bi-exclamation-triangle"></i> No data available. The table is empty or hasn't been loaded yet.
</div>
{% endif %}
{% endblock %}
